MODULE DTVDIFF_MOD
CONTAINS
SUBROUTINE DTVDIFF1(K,ETAPSI,MF2K,L,LB,DTVD1L,DTVD1LB)
!THIS SUBROUTINE CALCULATE VARIOUS DIFFERENTIAL KERNAL CORRESPONDING 0<K<K_UV

  USE CONST_SAVE , ONLY : NF,NC,V3
  USE TMU_MOD
  USE STRUCFUN_MOD
  USE FNF_MOD

  IMPLICIT NONE

  REAL(16),INTENT(IN) :: K,ETAPSI,MF2K
  REAL(16),INTENT(IN) :: L,LB
  REAL(16),INTENT(OUT) :: DTVD1L,DTVD1LB
  REAL(16) :: MF2
  REAL(16) :: XFF,XFA
  REAL(16) :: NF0,NF1,NF2
  REAL(16) :: NFD1L,NFD1LB
  REAL(16) :: NFD1LF,NFD1LBF,NFD1LA,NFD1LBA

  MF2=MF2K/(K**2)

  XFF=-MU + (K*SQRT(1.Q+0 + MF2))
  XFA=MU + (K*SQRT(1.Q+0 + MF2))

  CALL FNF012(XFF,T,L,LB,NF0,NF1,NF2)

  NFD1L=-(NF2*(-1 + 3*NF0 + 3*LB*NF1 + 3*L*NF2))
  NFD1LB=-(NF1*(-2 + 3*NF0 + 3*LB*NF1 + 3*L*NF2))/2.Q+0

  NFD1LF=NFD1L
  NFD1LBF=NFD1LB

  CALL FNF012(XFA,T,LB,L,NF0,NF1,NF2)

  NFD1L=-(NF2*(-1 + 3*NF0 + 3*L*NF1 + 3*LB*NF2))
  NFD1LB=-(NF1*(-2 + 3*NF0 + 3*L*NF1 + 3*LB*NF2))/2.Q+0

  NFD1LA=NFD1L
  NFD1LBA=NFD1LB

  DTVD1L=(-2*(1 - ETAPSI/4.Q+0)*K**4*NC*NF*(-NFD1LBA - NFD1LF)*V3)/(3.Q+0*SQRT(1.Q+0 + MF2))
  DTVD1LB=(-2*(1 - ETAPSI/4.Q+0)*K**4*NC*NF*(-NFD1LA - NFD1LBF)*V3)/(3.Q+0*SQRT(1.Q+0 + MF2))

END SUBROUTINE DTVDIFF1
END MODULE DTVDIFF_MOD
